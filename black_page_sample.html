<script>
    function loadedFunc(fsn) {
        var container = document.querySelector(".container");
        var imgTag = document.querySelector(".container>img");
        var imgUrl = null;

        try {
            imgUrl = fsn.getUrlParam("img_url", null, null);
            if (imgUrl) {
                imgUrl = decodeURIComponent(imgUrl);
                // 'startsWith'를 'indexOf'로 변경 (ES5 호환성)
                if (imgUrl.indexOf("http://image.cauly.co.kr/") === 0) {
                    imgUrl = imgUrl.replace("http://image.cauly.co.kr/", "https://image.cauly.co.kr/");
                }
            }
        } catch (err) {
            console.error("img_url 처리 중 오류:", err);
            imgUrl = null; // 오류 발생 시 null로 초기화
        }

        if (imgUrl == null || imgUrl == "null") {
            console.error("img_url 파라미터는 필수값입니다.");
        } else {
            // 화살표 함수를 일반 'function'으로 변경 (ES5 호환성)
            fsn.imgLoad(imgTag, imgUrl, function(bgColor) {
                if (bgColor) {
                    document.body.style.backgroundColor = bgColor;
                }
            });
        }

        var clkUrl = null;
        try {
            clkUrl = fsn.getUrlParam("clk_url", null, null);
            if (clkUrl) {
                clkUrl = decodeURI(clkUrl);
            }
        } catch (err) {
            console.error("clk_url 처리 중 오류:", err);
            clkUrl = null; // 오류 발생 시 null로 초기화
        }

        if (clkUrl == null || clkUrl == "null") {
            console.error("clk_url 파라미터는 필수값입니다.");
        } else {
            // 화살표 함수를 일반 'function'으로 변경 (ES5 호환성)
            fsn.addFsnEventListener(container, false, true, function(evt) {
                return clkUrl;
            });
            fsn.xBackgroundClickUrl(clkUrl);
        }
    }

    function initFsnAdtmplt() {
        var protocol = window.location.protocol;
        if (protocol !== "http:") {
            protocol = "https:";
        }
        var libUrl = protocol + "//image.cauly.co.kr/adtmplt/assets/fsn-lib/fsn_adtmplt_001";
        
        var linkElem = document.createElement("link");
        linkElem.rel = "stylesheet";
        linkElem.type = "text/css";
        linkElem.href = libUrl + ".css";
        document.head.appendChild(linkElem);
        
        var scriptElem = document.createElement("script");
        scriptElem.type = "text/javascript";
        scriptElem.src = libUrl + ".js";
        scriptElem.onload = function() {
            new FsnAdtmplt(loadedFunc);
        };
        document.head.appendChild(scriptElem);
    }
    
    document.addEventListener("DOMContentLoaded", initFsnAdtmplt);
</script>
